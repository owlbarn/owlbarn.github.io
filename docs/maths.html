<html style="" lang="en" class="js flexbox fontface"><head><meta charset="utf-8"><meta content="width=device-width, initial-scale=1.0" name="viewport"><meta content="OCaml Scientific and Engineering Computing - Tutorial Book" name="description"><meta content="OCaml, Data Science, Data Analytics, Analytics, Functional Programming, Machine Learning, Deep Neural Network, Scientific Computing, Numerical Algorithm, Tutorial, Linear Algebra, Matrix" name="keywords"><meta content="Liang Wang" name="author"><title>Mathematical Functions - OCaml Scientific Computing Tutorials</title><link href="css/app.css" rel="stylesheet"><link href="css/prism.css" rel="stylesheet"><script src="js/min/modernizr-min.js"></script><script src="js/prism.js"></script><script src="https://use.typekit.net/gfj8wez.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script><script>try{Typekit.load();}catch(e){}</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1868946892712371" crossorigin="anonymous"></script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-123353217-1"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-123353217-1');</script></head><body><div class="title-bar"><div class="title"><h1>OCaml Scientific Computing Tutorials</h1><h5></h5><nav><a href="index.html">Home</a><a href="toc.html">Table of Contents</a><a href="https://ocaml.xyz/owl/">API Docs</a></nav></div></div><div class="wrap"><div class="left-column"><a class="to-chapter" href="toc.html"><small>Back</small><h5>Table of Contents</h5></a></div><article class="main-body"><section class="level1" id="mathematical-functions">
<h1>Mathematical Functions</h1>
<p>Staring from this chapter, we begin our journey to explore the world of numerical computing with Owl. But let’s not be hasty. Before the main dishes such as algorithmic differentiation, optimisation, computation graph, etc., let’s taste some starters first. In this chapter, we will introduce how the familiar mathematical operations are supported in Owl. This chapter is organised according to different types of functions, and you can feel free to browse any of them. Note that functions in this chapter works on scalar values. The N-dimensional array module introduced in later chapters contains these basic functions that work on n-dimensional arrays, including vectors and matrices.</p>
<section class="level2" id="basic-functions">
<h2>Basic Functions</h2>
<section class="level3" id="basic-unary-math-functions">
<h3>Basic Unary Math Functions</h3>
<p>Many basic mathematic functions take one float number as input and return one float number. We call them <em>unary</em> functions. You can use these unary functions easily from the <code>Maths</code> module. For example:</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">Maths.sqrt 2.
&gt;- : float = 1.41421356237309515
</code></pre>
</div>
<p>The <span data-cites="tbl:maths:basic_unary" class="citation">[@tbl:maths:basic_unary]</span> lists these unary functions supported in this module.</p>
<table style="width:97%;">
<caption>Basic unary math functions {#tbl:maths:basic_unary}</caption>
<colgroup>
<col style="width: 19%">
<col style="width: 77%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Function</th>
<th style="text-align: left;">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>abs</code></td>
<td style="text-align: left;"><code>|x|</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>neg</code></td>
<td style="text-align: left;"><code>-x</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>reci</code></td>
<td style="text-align: left;"><code>1/x</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>floor</code></td>
<td style="text-align: left;">the largest integer that is smaller than <code>x</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>ceil</code></td>
<td style="text-align: left;">the smallest integer that is larger than <code>x</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>round</code></td>
<td style="text-align: left;">rounds <code>x</code> towards the bigger integer when on the fence</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>trunc</code></td>
<td style="text-align: left;">integer part of <code>x</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>sqr</code></td>
<td style="text-align: left;"><span class="math inline">\(x^2\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>sqrt</code></td>
<td style="text-align: left;"><span class="math inline">\(\sqrt{x}\)</span></td>
</tr>
</tbody>
</table>
</section>
<section class="level3" id="basic-binary-functions">
<h3>Basic Binary Functions</h3>
<p>Unlike the unary ones, the <em>binary functions</em> take two floats as inputs and return one float as output. Most common arithmetic functions belong to this category, as shown in <span data-cites="tbl:maths:binary" class="citation">[@tbl:maths:binary]</span>.</p>
<table style="width:97%;">
<caption>Binary math functions {#tbl:maths:binary}</caption>
<colgroup>
<col style="width: 19%">
<col style="width: 77%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Function</th>
<th style="text-align: left;">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>add</code></td>
<td style="text-align: left;"><code>x + y</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>sub</code></td>
<td style="text-align: left;"><code>x - y</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>mul</code></td>
<td style="text-align: left;"><code>x * y</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>div</code></td>
<td style="text-align: left;"><code>x / y</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>fmod</code></td>
<td style="text-align: left;"><code>x % y</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>pow</code></td>
<td style="text-align: left;"><span class="math inline">\(x^y\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>hypot</code></td>
<td style="text-align: left;"><span class="math inline">\(\sqrt{x^2 + y^2}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>atan2</code></td>
<td style="text-align: left;">returns <span class="math inline">\(\arctan(y/x)\)</span>, accounting for the sign of the arguments; this is the angle to the vector <span class="math inline">\((x, y)\)</span> counting from the x-axis.</td>
</tr>
</tbody>
</table>
</section>
<section class="level3" id="exponential-and-logarithmic-functions">
<h3>Exponential and Logarithmic Functions</h3>
<p>The constant <span class="math inline">\(e = \sum_{n=0}^{\infty}\frac{1}{n!}\)</span> is what we call the <em>natural constant</em>. It is named this way because the exponential function and its inverse function logarithm are so frequently used in nature and our daily life: logarithmic spiral, population growth, carbon date ancient artifacts, computing bank investments, etc. As an example, in a scientific experiment about bacteria, we can assume the number of bacterial at time <span class="math inline">\(t\)</span> follows an exponential function <span class="math inline">\(n(t) = Ce^rt\)</span> where <span class="math inline">\(C\)</span> is the initial population and <span class="math inline">\(r\)</span> is the daily increase rate. With this model, we can predict how the population of bacterial grows within certain time.</p>
<p>We also have this beautiful Euler’s formula that connects the two most frequently used constants and the base of complex numbers and natural numbers:</p>
<p><span class="math display">\[e^{i\pi}+ 1=0.\]</span></p>
<p>The full list of exponential and logarithmic functions, together with some handy variants, are presented in <span data-cites="tbl:maths:explog" class="citation">[@tbl:maths:explog]</span>.</p>
<table style="width:97%;">
<caption>Exponential and logarithmic math functions {#tbl:maths:explog}</caption>
<colgroup>
<col style="width: 19%">
<col style="width: 77%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Function</th>
<th style="text-align: left;">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>exp</code></td>
<td style="text-align: left;">exponential <span class="math inline">\(e^x\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>exp2</code></td>
<td style="text-align: left;"><span class="math inline">\(2^x\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>exp10</code></td>
<td style="text-align: left;"><span class="math inline">\(10^x\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>expm1</code></td>
<td style="text-align: left;">returns <span class="math inline">\(\exp(x) - 1\)</span> but more accurate for <span class="math inline">\(x \sim 0\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>log</code></td>
<td style="text-align: left;"><span class="math inline">\(\log_e~x\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>log2</code></td>
<td style="text-align: left;"><span class="math inline">\(\log_2~x\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>log10</code></td>
<td style="text-align: left;"><span class="math inline">\(\log_10~x\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>logn</code></td>
<td style="text-align: left;"><span class="math inline">\(\log_n~x\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>log1p</code></td>
<td style="text-align: left;">inverse of <code>expm1</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>logabs</code></td>
<td style="text-align: left;"><span class="math inline">\(\log(|x|)\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>xlogy</code></td>
<td style="text-align: left;"><span class="math inline">\(x \log(y)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>xlog1py</code></td>
<td style="text-align: left;"><span class="math inline">\(x \log(y+1)\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>logit</code></td>
<td style="text-align: left;"><span class="math inline">\(\log(p/(1-p))\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>expit</code></td>
<td style="text-align: left;"><span class="math inline">\(1/(1+\exp(-x))\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>log1mexp</code></td>
<td style="text-align: left;"><span class="math inline">\(\log(1-\exp(x))\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>log1pexp</code></td>
<td style="text-align: left;"><span class="math inline">\(\log(1+\exp(x))\)</span></td>
</tr>
</tbody>
</table>
</section>
<section class="level3" id="trigonometric-functions">
<h3>Trigonometric Functions</h3>
<p>The sine, cosine, and tangent functions belong to the <em>trigonometric functions</em>, which relate ratios of two side lengths to an angle of a right-angled triangle. They include the commonly used <code>sin</code> and <code>cos</code> etc., and their reciprocals such as the cosecant, secant, etc. These functions are widely used in the numerical computation applications of different fields, such as mechanics and geometry. The triangular functions are all unary functions, for example:</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">Maths.sin (Owl_const.pi /. 2.)
&gt;- : float = 1.
</code></pre>
</div>
<p>They are all included in the math module in Owl, as shown in <span data-cites="tbl:maths:triangular" class="citation">[@tbl:maths:triangular]</span>.</p>
<table>
<caption>Trigonometric math functions {#tbl:maths:triangular}</caption>
<colgroup>
<col style="width: 12%">
<col style="width: 15%">
<col style="width: 31%">
<col style="width: 41%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Function</th>
<th style="text-align: left;">Explanation</th>
<th style="text-align: left;">Derivatives</th>
<th style="text-align: left;">Taylor Expansion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>sin</code></td>
<td style="text-align: left;"><span class="math inline">\(\sin(x)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\cos(x)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\sum_{n=1}(-1)^{n+1}\frac{x^{2n+1}}{(2n+1)!}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>cos</code></td>
<td style="text-align: left;"><span class="math inline">\(\cos(x)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(-\sin(x)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\sum_{n=1}(-1)^n\frac{x^{2n}}{(2n)!}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>tan</code></td>
<td style="text-align: left;"><span class="math inline">\(\tan(x)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(1 + \tan^2(x)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\sum_{n=1}\frac{4^n(4^n-1)B_n~x^{2n-1}}{(2n)!}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>cot</code></td>
<td style="text-align: left;"><span class="math inline">\(1/\tan(x)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(-(1 + \textrm{cot}^2(x))\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\sum_{n=0}\frac{E_n~x^{2n}}{(2n)!}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>sec</code></td>
<td style="text-align: left;"><span class="math inline">\(1/\cos(x)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\textrm{sec}(x)\tan(x)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\sum_{n=0}\frac{2(2^{2n-1})B_n~x^{2n-1}}{(2n)!}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>csc</code></td>
<td style="text-align: left;"><span class="math inline">\(1/\sin(x)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(-\textrm{csc}(x)\textrm{cot}(x)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\frac{1}{x}-\sum_{n=1}\frac{4^n~B_n~x^{2n-1}}{(2n)!}\)</span></td>
</tr>
</tbody>
</table>
<p>Here the <span class="math inline">\(B_n\)</span> is the <span class="math inline">\(n\)</span>th <a href="https://en.wikipedia.org/wiki/Bernoulli_number">Bernoulli number</a>, and <span class="math inline">\(E_n\)</span> is the <span class="math inline">\(n\)</span>th <a href="https://en.wikipedia.org/wiki/Euler_number">Euler number</a>. The <span data-cites="fig:algodiff:trio" class="citation">[@fig:algodiff:trio]</span> shows the relationship between these trigonometric functions. This figure is inspired by a <a href="https://zh.wikipedia.org/wiki/%E5%8F%8C%E6%9B%B2%E5%87%BD%E6%95%B0">wiki post</a>. These functions also have corresponding inverse functions: <code>asin</code>, <code>acos</code>, <code>atan</code>, <code>acot</code>, <code>asec</code>, <code>acsc</code>. For example, if <span class="math inline">\(\sin(a) = b\)</span>, then <span class="math inline">\(\textrm{asin}(b) = a\)</span>.</p>
<figure>
<img style="width:60.0%" id="fig:algodiff:trio" alt="Relationship between different trigonometric functions" title="trio" src="images/maths/trio.png"><figcaption>Relationship between different trigonometric functions</figcaption>
</figure>
<p>Another related idea is the <em>Hyperbolic functions</em> such as <code>sinh</code> and <code>cosh</code>. These functions are defined using exponential functions. We have seen in [@#fig:algodiff:trio] that the trigonometric functions are related to a circle. Similarly, the hyperbolic functions are related to a hyperbola. For example, the points <code>(cosh(x), sinh(x))</code> form the right half of the equilateral hyperbola, just like <code>(cos(x), sin(x))</code> on a circle. The hyperbolic functions is applied widely in numerical computing, such as in the differential equation solutions, hyperbolic geometry, etc.<br>
These functions in Owl are shown below:</p>
<ul>
<li><code>sinh</code>: <span class="math inline">\(\frac{e^x - e^{-x}}{2}\)</span>, derivative is <span class="math inline">\(\cosh(x)\)</span>, and taylor expansion is <span class="math inline">\(\sum_{n=0}\frac{x^{2n+1}}{(2n+1)!}\)</span>.</li>
<li><code>cosh</code>: <span class="math inline">\(\frac{e^x + e^{-x}}{2}\)</span>, derivative is <span class="math inline">\(\sinh(x)\)</span>, and taylor expansion is <span class="math inline">\(\sum_{n=0}\frac{x^{2n+1}}{(2n+1)!}\)</span>.</li>
<li><code>tanh</code>: <span class="math inline">\(\frac{\sinh{x}}{\cosh{x}}\)</span>, derivative is <span class="math inline">\(1-\tanh^2(x)\)</span>, and taylor expansion is <span class="math inline">\(\sum_{n=1}\frac{4^n(4^n-1)B_{2n}~x^{2n-1}}{(2n)!}\)</span>.</li>
<li><code>coth</code>: <span class="math inline">\(\frac{\cosh{x}}{\sinh{x}}\)</span>, derivative is <span class="math inline">\(1-\coth^2(x)\)</span>, and taylor expansion is <span class="math inline">\(\frac{1}{x}-\sum_{n=1}\frac{4^n~B_{2n}~x^{2n-1}}{(2n)!}\)</span>.</li>
<li><code>sech</code>: <span class="math inline">\(1/\cosh(x)\)</span>, derivative is <span class="math inline">\(-\tanh(x)/\cosh(x)\)</span>, and taylor expansion is <span class="math inline">\(\sum_{n=0}\frac{E_{2n}~x^{2n}}{(2n)!}\)</span>.</li>
<li><code>csch</code>:<span class="math inline">\(1/\sinh(x)\)</span>, derivative is <span class="math inline">\(-\coth(x)/\sinh(x)\)</span>, and taylor expansion is <span class="math inline">\(\frac{1}{x}+\sum_{n=1}\frac{2(1-2^{2n-1})B_{2n}~x^{2n-1}}{(2n)!}\)</span>.</li>
</ul>
<p>Similarly, each of these functions has a corresponding inverse functions: <code>asinh</code>, <code>acosh</code>, <code>atanh</code>, <code>acoth</code>, <code>asech</code>, <code>acsch</code>. The relationship between these hyperbolic trigonometric functions are clearly depicted in <span data-cites="fig:algodiff:hyper_trio" class="citation">[@fig:algodiff:hyper_trio]</span>.</p>
<figure>
<img style="width:70.0%" id="fig:algodiff:hyper_trio" alt="Relationship between different hyperbolic trigonometric functions" title="hyper_trio" src="images/maths/hyper_trio.png"><figcaption>Relationship between different hyperbolic trigonometric functions</figcaption>
</figure>
<p>Besides these functions, there are also some related functions. <code>sinc</code> returns <span class="math inline">\(\sin(x)/x\)</span> and 1 for <span class="math inline">\(x=0\)</span>. <code>logsinh</code> returns <span class="math inline">\(\log(\sinh(x))\)</span> but handles large <span class="math inline">\(|x|\)</span>. <code>logcosh</code> returns <span class="math inline">\(\log(\cosh(x))\)</span> but handles large <span class="math inline">\(|x|\)</span>. <code>sindg</code>/<code>cosdg</code>/<code>tandg</code>/<code>cotdg</code> are the sine/cosine/tangent/cotangent of the angle given in degrees.</p>
</section>
<section class="level3" id="other-math-functions">
<h3>Other Math Functions</h3>
<p>There are some other functions that may not be very commonly used in traditional mathematics. Functions such as <code>sigmoid</code> and <code>relu</code> are frequently used in the Deep Learning as the activation functions in a neural network. The activation functions are crucial to the neural network regarding various aspects, including output result, accuracy, convergence speed, etc. We will talk about them in detail in the Neural Network chapter later in this book.</p>
<ul>
<li><code>sigmoid x</code>: <span class="math inline">\(1 / (1 + \exp(-x))\)</span></li>
<li><code>signum x</code>: returns the sign of <code>x</code>: -1, 0, or 1</li>
<li><code>softsign x</code>: smooths <code>sign</code> function</li>
<li><code>relu x</code>: <span class="math inline">\(\max(0, x)\)</span></li>
</ul>
</section>
</section>
<section class="level2" id="special-functions">
<h2>Special Functions</h2>
<p>Besides what we have just listed, there are also a lot special functions. You may not heard of them before, but they have established names and are important in different fields such as mathematical analysis, physics, etc. In Owl, the implementations of these functions rely on the <a href="http://www.netlib.org/cephes/">Cephes Mathematical Functions Library</a>, a C language library with special functions of interest to scientists and engineers. They are list in the rest of this section. Perhaps we cannot dig deep into the mathematical or physical implication of all these functions, but you may find them handy when you need one.</p>
<section class="level3" id="airy-functions">
<h3>Airy Functions</h3>
<p>The Airy function <code>Ai(x)</code> is named after the British astronomer George B. Airy. It is the solution of the second order linear differential equation:</p>
<p><span class="math display">\[y''(x) = xy(x).\]</span></p>
<p>This differential equation has two linearly independent solutions <code>Ai</code> and <code>Bi</code>. Owl provides the <code>airy</code> function to do that:</p>
<div class="highlight">
<pre><code class="language-clike">val airy : float -&gt; float * float * float * float</code></pre>
</div>
<p>The four returned numbers are <code>Ai</code>, its derivative <code>Ai'</code>, <code>Bi</code>, and its derivative <code>Bi'</code>. Let’s look at an example. It plots the two solutions <code>Ai</code> and <code>Bi</code> in <span data-cites="fig:algodiff:airy" class="citation">[@fig:algodiff:airy]</span>.</p>
<div class="highlight">
<pre><code class="language-ocaml">let x = Mat.linspace (-15.) 5. 200

let y0 = Mat.map (fun x -&gt;
    let ai, _, _, _ = Maths.airy x in ai
) x

let y1 = Mat.map (fun x -&gt;
    let _, _, bi, _ = Maths.airy x in bi
) x

let _ =
  let h = Plot.create "special_airy.png" in
  Plot.(plot ~h ~spec:[ RGB (66, 133, 244); LineStyle 1; LineWidth 2. ] x y0);
  Plot.(plot ~h ~spec:[ RGB (219, 68,  55); LineStyle 2; LineWidth 2. ] x y1);
  Plot.(set_yrange h (-0.5) 1.);
  Plot.(legend_on h ~position:SouthEast [|"Ai"; "Bi"|]);
  Plot.output h</code></pre>
</div>
<figure>
<img style="width:60.0%" id="fig:algodiff:airy" alt="Examples of the two solutions of an Airy equation" title="airy" src="images/maths/example_airy.png"><figcaption>Examples of the two solutions of an Airy equation</figcaption>
</figure>
</section>
<section class="level3" id="bessel-functions">
<h3>Bessel Functions</h3>
<p>Bessel functions, first defined by the mathematician Daniel Bernoulli and then generalized by Friedrich Bessel, are canonical solutions of Bessel’s differential equation:</p>
<p><span class="math display">\[x^2y''+xy'+(x^2 - \alpha^2)y = 0.\]</span></p>
<p>The complex number <span class="math inline">\(\alpha\)</span> is called the “order” of the bessel function. Bessel functions are important for many problems in studying the wave propagation and static potentials, such as electromagnetic waves in a cylindrical waveguide. In solving cylindrical coordinate systems, Bessel functions of integer order or half integer order are often used.</p>
<p>The Bessel functions can be divided into two kinds. Both kinds are solutions to the Bessel’s differential equations, but the first kind is non-singular at the origin, while the second kind is singular at the origin (<span class="math inline">\(x=0\)</span>). A special case is when <span class="math inline">\(x\)</span> is purely imaginary. In this case, the solutions are called the modified Bessel functions, which can also be categorised into first kind and second kind. Based on these category, Owl provides these functions.</p>
<table style="width:76%;">
<caption>Bessel functions {#tbl:maths:bessel}</caption>
<colgroup>
<col style="width: 12%">
<col style="width: 63%">
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th style="text-align: left;">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>j0 x</code></td>
<td style="text-align: left;">Bessel function of the first kind of order 0</td>
</tr>
<tr class="even">
<td><code>j1 x</code></td>
<td style="text-align: left;">Bessel function of the first kind of order 1</td>
</tr>
<tr class="odd">
<td><code>jv x y</code></td>
<td style="text-align: left;">Bessel function of the first kind of real order</td>
</tr>
<tr class="even">
<td><code>y0 x</code></td>
<td style="text-align: left;">Bessel function of the second kind of order 0</td>
</tr>
<tr class="odd">
<td><code>y1 x</code></td>
<td style="text-align: left;">Bessel function of the second kind of order 1</td>
</tr>
<tr class="even">
<td><code>yv x y</code></td>
<td style="text-align: left;">Bessel function of the second kind of real order</td>
</tr>
<tr class="odd">
<td><code>yn a x</code></td>
<td style="text-align: left;">Bessel function of the second kind of integer order</td>
</tr>
<tr class="even">
<td><code>i0 x</code></td>
<td style="text-align: left;">Modified Bessel function of order 0</td>
</tr>
<tr class="odd">
<td><code>i1 x</code></td>
<td style="text-align: left;">Modified Bessel function of order 1</td>
</tr>
<tr class="even">
<td><code>iv x y</code></td>
<td style="text-align: left;">Modified Bessel function of real order</td>
</tr>
<tr class="odd">
<td><code>i0e x</code></td>
<td style="text-align: left;">Exponentially scaled modified Bessel function of order 0</td>
</tr>
<tr class="even">
<td><code>i1e x</code></td>
<td style="text-align: left;">Exponentially scaled modified Bessel function of order 1</td>
</tr>
<tr class="odd">
<td><code>k0 x</code></td>
<td style="text-align: left;">Modified Bessel function of the second kind of order 0</td>
</tr>
<tr class="even">
<td><code>k1</code></td>
<td style="text-align: left;">Modified Bessel function of the second kind of order 1</td>
</tr>
<tr class="odd">
<td><code>k0e</code></td>
<td style="text-align: left;">Exponentially scaled modified Bessel function of the second kind of order 0</td>
</tr>
<tr class="even">
<td><code>k1e</code></td>
<td style="text-align: left;">Exponentially scaled modified Bessel function of the second kind of order 1</td>
</tr>
</tbody>
</table>
<p>In the example below, we plot the first kind Bessel function of order 0, 1, and 2, as shown in <span data-cites="fig:algodiff:bessel" class="citation">[@fig:algodiff:bessel]</span>.</p>
<div class="highlight">
<pre><code class="language-ocaml">let x = Mat.linspace (0.) 20. 200

let y0 = Mat.map Maths.j0 x

let y1 = Mat.map Maths.j1 x

let y2 = Mat.map (Maths.jv 2.) x

let _ =
  let h = Plot.create "example_bessel.png" in
  Plot.(plot ~h ~spec:[ RGB (66, 133, 244); LineStyle 1; LineWidth 2. ] x y0);
  Plot.(plot ~h ~spec:[ RGB (219, 68,  55); LineStyle 2; LineWidth 2. ] x y1);
  Plot.(plot ~h ~spec:[ RGB (244, 180,  0); LineStyle 3; LineWidth 2. ] x y2);
  Plot.(legend_on h ~position:NorthEast [|"j0"; "j1"; "j2"|]);
  Plot.output h</code></pre>
</div>
<figure>
<img style="width:60.0%" id="fig:algodiff:bessel" alt="Examples of Bessel function of the first kind, with different order" title="bessel" src="images/maths/example_bessel.png"><figcaption>Examples of Bessel function of the first kind, with different order</figcaption>
</figure>
</section>
<section class="level3" id="elliptic-functions">
<h3>Elliptic Functions</h3>
<p>The <em>Jacobian elliptic functions</em> are used in studying the pendulum motion. There are twelve Jacobi elliptic functions and <code>ellipj</code> we include here in Owl returns three of them: <code>sn</code>, <code>cn</code>, and <code>dn</code>. The fourth output <code>phi</code> of this function is called the amplitude of input <code>u</code>.</p>
<p>On the other hand, the <em>Elliptic integrals</em> are initially used to find the perimeters of ellipses. A Elliptic integral function can be expressed in the form of: <span class="math display">\[f(x)=\int_c^xR(t, \sqrt(P(t)))dt,\]</span> where <span class="math inline">\(R\)</span> is a rational function of its two arguments, <span class="math inline">\(P\)</span> is a polynomial of degree 3 or 4 with no repeated roots, and <span class="math inline">\(c\)</span> is a constant. An elliptic integral can be categorised as “complete” or “incomplete”. The former one is function of a single argument, while the latter contains two arguments. Each elliptic integral can be transformed so that it contains integrals of rational functions and the three Legendre canonical forms, according to which the elliptic can be categorised into the first, second, and third kind. The elliptic functions in Owl are listed in <span data-cites="tbl:maths:elliptic" class="citation">[@tbl:maths:elliptic]</span>.</p>
<table>
<caption>Elliptic functions {#tbl:maths:elliptic}</caption>
<colgroup>
<col style="width: 21%">
<col style="width: 78%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Function</th>
<th style="text-align: left;">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>ellipj u m</code></td>
<td style="text-align: left;">Jacobian elliptic functions of parameter <code>m</code> between 0 and 1, and real argument <code>u</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>ellipk m</code></td>
<td style="text-align: left;">Complete elliptic integral of the first kind</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>ellipkm1 p</code></td>
<td style="text-align: left;">Complete elliptic integral of the first kind around m = 1</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>ellipkinc phi m</code></td>
<td style="text-align: left;">Incomplete elliptic integral of the first kind</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>ellipe m</code></td>
<td style="text-align: left;">Complete elliptic integral of the second kind</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>ellipeinc phi m</code></td>
<td style="text-align: left;">Incomplete elliptic integral of the second kind</td>
</tr>
</tbody>
</table>
<p>We can use <code>ellipe</code> to compute the circumference of an ellipse. To compute that normally requires calculus, but the elliptic functions provides a simple solution. Suppose an ellipse has semi-major axis <span class="math inline">\(a=4\)</span> and semi-minor axis <span class="math inline">\(b=3\)</span>. We an compute its circumference simply using <span class="math inline">\(4a\textrm{ellipe}(1 - \frac{b^2}{a^2})\)</span>.</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">let a = 4.
&gt;val a : float = 4.
let b = 3.
&gt;val b : float = 3.
let c = 4. *. a *. Maths.(ellipe (1. -. pow (b /. a) 2.))
&gt;val c : float = 22.1034921607095072
</code></pre>
</div>
</section>
<section class="level3" id="gamma-functions">
<h3>Gamma Functions</h3>
<p>For a positive integer n, the <em>Gamma function</em> is the factorial function:</p>
<p><span class="math display">\[\Gamma(n) = (n-1)!\]</span></p>
<p>For a complex numbers <span class="math inline">\(z\)</span> with a positive real part, the Gamma function is defined as:</p>
<p><span class="math display">\[\Gamma(z) = \int_0^{\infty}x^{z-1}e^{-x}dx.\]</span></p>
<p>Here the gamma function is an integral from zero to infinity. If we change it to an integral from zero to a certain upper limit, it is called the “lower incomplete gamma function”. Similarly, if it is an integral from a certain lower limit to infinity, the integral is called the “upper incomplete gamma function”.</p>
<p>The Gamma function is widely used in a range of areas such as fluid dynamics, geometry, astrophysics, etc. It is especially suitable for describing a common pattern of processes that decay exponentially in time or space. The Gamma function and related function provided in Owl are listed in <span data-cites="tbl:maths:gamma" class="citation">[@tbl:maths:gamma]</span>.</p>
<table>
<caption>Gamma functions {#tbl:maths:gamma}</caption>
<colgroup>
<col style="width: 32%">
<col style="width: 67%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Function</th>
<th style="text-align: left;">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>gamma z</code></td>
<td style="text-align: left;">Returns the value of the Gamma function</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>rgamma z</code></td>
<td style="text-align: left;">Reciprocal of the Gamma function</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>loggamma z</code></td>
<td style="text-align: left;">Principal branch of the logarithm of the Gamma function</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>gammainc a x</code></td>
<td style="text-align: left;">Regularized lower incomplete gamma function</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>gammaincinv a y</code></td>
<td style="text-align: left;">Inverse function of <code>gammainc</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>gammaincc a x</code></td>
<td style="text-align: left;">Complemented incomplete gamma integral</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>gammainccinv a y</code></td>
<td style="text-align: left;">Inverse function of <code>gammaincc</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>psi z</code></td>
<td style="text-align: left;">The digamma function</td>
</tr>
</tbody>
</table>
<p>Here is an example of using <code>gamma</code>.</p>
<div class="highlight">
<pre><code class="language-ocaml">let x = Mat.linspace (-3.5) 5. 2000

let y = Mat.map Maths.gamma x

let _ =
  let h = Plot.create "example_gamma.png" in
  Plot.(plot ~h ~spec:[ RGB (66, 133, 244); LineStyle 1; LineWidth 2. ] x y);
  Plot.(set_yrange h (-10.) 20.);
  Plot.output h</code></pre>
</div>
<figure>
<img style="width:60.0%" id="fig:algodiff:gamma" alt="Examples of Gamma function along part of the real axis" title="gamma" src="images/maths/example_gamma.png"><figcaption>Examples of Gamma function along part of the real axis</figcaption>
</figure>
</section>
<section class="level3" id="beta-functions">
<h3>Beta Functions</h3>
<p>Beta function is defined as:</p>
<p><span class="math display">\[B(x,y) = \int_0^1t^{x-1}(1-t)^{y-1}dt = \frac{\Gamma(x)\Gamma(y)}{\Gamma(x+y)}\]</span></p>
<p>Here <span class="math inline">\(\Gamma\)</span> is the Gamma function, and similar to it, the Beta function has its “incomplete” version. The incomplete Beta function extends this definition to:</p>
<p><span class="math display">\[B(x, a, b) = \int_0^xt^{a-1}(1-t)^{b-1}dt.\]</span></p>
<p>In Owl the Beta function is called using the <code>beta x y</code> function from the <code>Maths</code> module, and its incomplete version is <code>betainc a b x</code>. We also provide the <code>betaincinv</code> function, which is the inverse of <code>betainc</code>.</p>
<p>The Beta function has several properties. For example, the code below shows the relationship between beta function and gamma function.</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">let x = Maths.beta 3. 4.
&gt;val x : float = 0.0166666666666666664
let y = Maths.((gamma 3.) *. (gamma 4.) /. (gamma (7.)))
&gt;val y : float = 0.0166666666666666664
</code></pre>
</div>
<p>Another property is its symmetricity, which means <span class="math inline">\(B(x,y) = B(y, x)\)</span>.</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">let x = Maths.beta 3. 4.
&gt;val x : float = 0.0166666666666666664
let y = Maths.beta 4. 3.
&gt;val y : float = 0.0166666666666666664
</code></pre>
</div>
<p>Beta function is the first known scattering amplitude in the String theory in physics. It is also used in the analysis of the preferential attachment process, a type of stochastic urn process that describes how the resource can be distributed among a group of individuals based on the existing resource each one has acquired.</p>
</section>
<section class="level3" id="struve-functions">
<h3>Struve Functions</h3>
<p>The <em>Struve function</em> is defined as: <span class="math display">\[H_v(x) = (z/2)^{v + 1} \sum_{n=0}^\infty \frac{(-1)^n (z/2)^{2n}}{\Gamma(n + \frac{3}{2}) \Gamma(n + v + \frac{3}{2})},\]</span></p>
<p>where <span class="math inline">\(\Gamma\)</span> is the Gamma function. <span class="math inline">\(x\)</span> must be positive unless <span class="math inline">\(v\)</span> is an integer. Struve functions are used across a wide variety of physics applications, such as water-wave problems and calculations in unsteady aerodynamics.</p>
<p>The Owl function <code>struve v x</code> returns the value of Struve function. The parameter <span class="math inline">\(v\)</span> is called the <em>order</em> of this function. Here is an example that shows the curves of Struve functions with order from 0 to 4.</p>
<div class="highlight">
<pre><code class="language-ocaml">let _ =
  let h = Plot.create "example_struve.png" in
  Plot.(plot_fun ~h ~spec:[ RGB (66, 133, 244); LineStyle 1; LineWidth 2.] (Maths.struve 0.) (-12.) 12.);
  Plot.(plot_fun ~h ~spec:[ RGB (219, 68,  55); LineStyle 2; LineWidth 2.] (Maths.struve 1.) (-12.) 12.);
  Plot.(plot_fun ~h ~spec:[ RGB (244, 180,  0); LineStyle 3; LineWidth 2.] (Maths.struve 2.) (-12.) 12.);
  Plot.(plot_fun ~h ~spec:[ RGB (77,  81,  57); LineStyle 1; LineWidth 2.] (Maths.struve 3.) (-12.) 12.);
  Plot.(plot_fun ~h ~spec:[ RGB (111, 51, 129); LineStyle 2; LineWidth 2.] (Maths.struve 4.) (-12.) 12.);
  Plot.(set_yrange h (-3.) 5.);
  Plot.(legend_on h ~position:SouthEast [|"H0"; "H1"; "H2"; "H3"; "H4"|]);
  Plot.output h</code></pre>
</div>
<figure>
<img style="width:60.0%" id="fig:algodiff:struve" alt="Examples of Struve function for different orders." title="struve" src="images/maths/example_struve.png"><figcaption>Examples of Struve function for different orders.</figcaption>
</figure>
</section>
<section class="level3" id="zeta-functions">
<h3>Zeta Functions</h3>
<p>The <em>Hurwitz zeta function</em> <code>zeta x q</code> is defined as:</p>
<p><span class="math display">\[\zeta(x, q) = \sum_{k=0}^{\infty}\frac{1}{(k+q)^x}.\]</span></p>
<p>When <span class="math inline">\(q\)</span> is set to 1, this function is reduced to the <em>Riemann zeta function</em>. The function <code>zetac x</code> returns Riemann zeta function minus 1. The zeta function is often used to analyse the dynamic systems. Besides, the Riemann zeta function plays an important role in number theory and is widely applied in quantum physics, probability theory, and applied statistics, etc.</p>
<p>We can evaluate the zeta function at certain points, for example:</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">Maths.zeta 4. 1.
&gt;- : float = 1.08232323371113837
(Maths.pow Owl_const.pi 4.) /. 90.
&gt;- : float = 1.08232323371113792
</code></pre>
</div>
</section>
<section class="level3" id="error-functions">
<h3>Error Functions</h3>
<p>The error functions here are not about error processing in programming, but yet another family of special functions. In mathematics, an error function is defined as: <span class="math display">\[\frac{2}{\sqrt{\pi}}\int_0^x e^{-t^2})dt.\]</span></p>
<p>The error function occurs often in probability and statistics. Actually, in statistics, for a non-negative value <code>x</code>, <code>erf x</code> is the probability that a random variable <code>y</code> falls in the range <code>[-x, x]</code>. Here <code>y</code> follows a normal distribution with mean 0 and variance 0.5. Since it represents certain probability, the <em>complementary</em> error function <code>1 - erf(x)</code> is also frequently used. The error function and related variants in Owl are listed in <span data-cites="tbl:maths:error" class="citation">[@tbl:maths:error]</span>.</p>
<table>
<caption>Error functions {#tbl:maths:error}</caption>
<colgroup>
<col style="width: 32%">
<col style="width: 67%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Function</th>
<th style="text-align: left;">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>erf x</code></td>
<td style="text-align: left;">Error function</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>erfc x</code></td>
<td style="text-align: left;">Complementary error function: <span class="math inline">\(1 - \textrm{erf}(x)\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>erfcx x</code></td>
<td style="text-align: left;">Scaled complementary error function: <span class="math inline">\(\exp(x^2) \mathrm{erfc}(x)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>erfinv x</code></td>
<td style="text-align: left;">Inverse function of <code>erf</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>erfcinv x</code></td>
<td style="text-align: left;">Inverse function of <code>erfc</code></td>
</tr>
</tbody>
</table>
<p>The error function is a sigmoid function. We can observe its shape by the code below.</p>
<div class="highlight">
<pre><code class="language-ocaml">let _ =
  let h = Plot.create "example_erf.png" in
  Plot.(plot_fun ~h ~spec:[ RGB (66, 133, 244); LineStyle 1; LineWidth 2.] Maths.erf (-3.) 3.);
  Plot.output h</code></pre>
</div>
<figure>
<img style="width:75.0%" id="fig:algodiff:erf" alt="Plot of the Error function." title="struve" src="images/maths/example_erf.png"><figcaption>Plot of the Error function.</figcaption>
</figure>
</section>
<section class="level3" id="integral-functions">
<h3>Integral Functions</h3>
<p>Besides what we have mentioned so far, Owl also provides several special integral functions.</p>
<p>For example, the <em>Dawson function</em> is defined as: <span class="math display">\[D(x) = e^{-x^2}\int_0^x~e^{t^2}dt\]</span></p>
<p>And the <em>Fresnel trigonometric integral</em> returns a tuple that contains two parts: <span class="math display">\[S(x) = \int_0^x~sin(t^2)dt, C(x) = \int_0^x~cos(t^2)dt.\]</span></p>
<p>Just like many otheer special functions, these two types of inegrals are motivated by research in physics, such as the electromagnetic problems. They are provided by the <code>dawsn</code> and <code>fresnel</code> functions in the <code>Maths</code> module respecitively. We can observe the functions of these integrals with plots.</p>
<div class="highlight">
<pre><code class="language-ocaml">let _ =
  let h = Plot.create ~m:1 ~n:2 "example_integrals.png" in
  Plot.subplot h 0 0;
  Plot.(plot_fun ~h ~spec:[ RGB (66, 133, 244); LineStyle 1; LineWidth 2.] Maths.dawsn (-5.) 5.);
  Plot.set_ylabel h "dawsn(x)";
  Plot.subplot h 0 1;
  Plot.(plot_fun ~h ~spec:[ RGB (66, 133, 244); LineStyle 1; LineWidth 2.] (fun x -&gt; let s, _ = Maths.fresnel x in s) 0. 5.);
  Plot.(plot_fun ~h ~spec:[ RGB (219, 68,  55); LineStyle 2; LineWidth 2.] (fun x -&gt; let _, c = Maths.fresnel x in c) 0. 5.);
  Plot.(legend_on h ~position:SouthEast [|"S(x)"; "C(x)"|]);
  Plot.set_ylabel h "fresnel(x)";
  Plot.output h</code></pre>
</div>
<figure>
<img style="width:100.0%" id="fig:algodiff:integrals" alt="Plot of the Dawson and Fresnel integral function." title="integrals" src="images/maths/example_integrals.png"><figcaption>Plot of the Dawson and Fresnel integral function.</figcaption>
</figure>
<p>Besides these two, several other type of special integral functions are also provided. The full list is shown in <span data-cites="tbl:maths:integral" class="citation">[@tbl:maths:integral]</span>.</p>
<table>
<caption>Special integral functions {#tbl:maths:integral}</caption>
<colgroup>
<col style="width: 23%">
<col style="width: 76%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Function</th>
<th style="text-align: left;">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>expn n x</code></td>
<td style="text-align: left;">Generalized exponential integral <span class="math inline">\(E_n(x) = x^{n-1}\int_x^{\infty}\frac{e^{-t}}{t^n}dt\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>shi x</code></td>
<td style="text-align: left;">Hyperbolic sine integral: <span class="math inline">\(\int_0^x~\frac{\sinh~t}{t}dt\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>chi x</code></td>
<td style="text-align: left;">Hyperbolic cosine integral: <span class="math inline">\(\gamma + \log(x) + \int_0^x~\frac{\cosh~t -1}{t}dt\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>shichi x</code></td>
<td style="text-align: left;">(<code>shi x</code>, <code>chi x</code>)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>si x</code></td>
<td style="text-align: left;">Sine integral: <span class="math inline">\(\int_0^x~\frac{\sin~t}{t}dt\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>ci x</code></td>
<td style="text-align: left;">Cosine integral: <span class="math inline">\(\gamma + \log(x) + \int_0^x~\frac{\cos~t -1}{t}dt\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>sici x</code></td>
<td style="text-align: left;">(<code>si x</code>, <code>ci x</code>)</td>
</tr>
</tbody>
</table>
</section>
</section>
<section class="level2" id="factorials">
<h2>Factorials</h2>
<p>After the functions, let’s turn to a concept that we are familiar with: the <em>factorials</em>. The definition of factorials is simple:</p>
<p><span class="math inline">\(F(n) = n! = n \times (n - 1) \times (n-2) \ldots \times 1\)</span></p>
<p>The factorial function, together with several of its variants, are contained in the <code>Math</code> module.</p>
<table>
<caption>Factorial functions {#tbl:maths:factorial}</caption>
<colgroup>
<col style="width: 23%">
<col style="width: 76%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Function</th>
<th style="text-align: left;">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>fact n</code></td>
<td style="text-align: left;">Factorial function <span class="math inline">\(!n\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>log_fact n</code></td>
<td style="text-align: left;">Logarithm of factorial function</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>doublefact n</code></td>
<td style="text-align: left;">Double factorial function calculates <span class="math inline">\(n!! = n(n-2)(n-4)\dots 2\)</span> (or 1)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>log_doublefact n</code></td>
<td style="text-align: left;">Logarithm of double factorial function</td>
</tr>
</tbody>
</table>
<p>The factorial functions accepts integer as input, for example:</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">Maths.fact 5
&gt;- : float = 120.
</code></pre>
</div>
<p>The factorials are applied in many areas of mathematics, most notably the combinatorics. The permutation and combination are both defined in factorials. The permutation function returns the number <span class="math inline">\(n!/(n-k)!\)</span> of ordered subsets of length <span class="math inline">\(k\)</span>, taken from a set of <span class="math inline">\(n\)</span> elements. The combination function returns the number <span class="math inline">\({n\choose k} = n!/(k!(n-k)!)\)</span> of subsets of <span class="math inline">\(k\)</span> elements of a set of <span class="math inline">\(n\)</span> elements. <span data-cites="tbl:maths:perm" class="citation">[@tbl:maths:perm]</span> provides the combinatorics functions you can use in the <code>Math</code> module.</p>
<table>
<caption>Permutation and combination functions {#tbl:maths:perm}</caption>
<colgroup>
<col style="width: 28%">
<col style="width: 71%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Function</th>
<th style="text-align: left;">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>permutation n k</code></td>
<td style="text-align: left;">Permutation number</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>permutation_float n k</code></td>
<td style="text-align: left;">Similar to <code>permutation</code> but deals with larger range and returns float</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>combination n k</code></td>
<td style="text-align: left;">Combination number</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>combination_float n k</code></td>
<td style="text-align: left;">Similar to <code>combination</code> but deals with larger range and returns float</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>log_combination n k</code></td>
<td style="text-align: left;">Returns the logarithm of <span class="math inline">\({n\choose k}\)</span></td>
</tr>
</tbody>
</table>
<p>Let’s take a look at a simple example.</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">let x = Maths.combination 10 2
&gt;val x : int = 45
let y = Maths.combination_float 10 2
&gt;val y : float = 45.
</code></pre>
</div>
</section>
<section class="level2" id="interpolation-and-extrapolation">
<h2>Interpolation and Extrapolation</h2>
<p>Sometimes we don’t know the full description of a function <span class="math inline">\(f\)</span>, but only some points on it, and therefore we cannot calculate its value at an aribitrary point. The target is to esimate the <span class="math inline">\(f(x)\)</span> for an arbitrary <span class="math inline">\(x\)</span> by drawing a smooth curve through the given data. If <span class="math inline">\(x\)</span> is within the range of the given data, this taks is called <em>interpolation</em>, otherwise it’s called <em>extrapolation</em>, which is much more difficult to do.</p>
<p>The <code>Owl_maths_interpolate</code> module provides an <code>polint</code> function for interpolation and extrapolation:</p>
<div class="highlight">
<pre><code class="language-clike">val polint : float array -&gt; float array -&gt; float -&gt; float * float</code></pre>
</div>
<p>The function <code>polint xs ys x</code> performs polynomial interpolation of the given arrays <code>xs</code> and <code>ys</code>. Given arrays <span class="math inline">\(xs[0 \ldots (n-1)]\)</span> and <span class="math inline">\(ys[0\ldots~(n-1)]\)</span>, and a value <code>x</code>, this function returns a value <code>y</code>, and an error estimate <code>dy</code>.</p>
<p>As its name suggests, the <code>polint</code> approximates complicated curves with polynomial of the lowest possible degree that passes the given points. We show how this interplation method works with an example. In the previous section we have said that the Gamma function is actually an interpolation solution to the integer function <span class="math inline">\(y(x) = (n-1)!\)</span>. So we can specify five nodes on a plane that are generated from this factorial functions, and see how the interpolation function works compared with the Gamma function itself.</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">let x = [|2; 3; 4; 5; 6|]
&gt;val x : int array = [|2; 3; 4; 5; 6|]
let y = Array.map (fun x -&gt; Maths.fact (x - 1)) x
&gt;val y : float array = [|1.; 2.; 6.; 24.; 120.|]
let x = Array.map float_of_int x
&gt;val x : float array = [|2.; 3.; 4.; 5.; 6.|]
</code></pre>
</div>
<p>Now we can define the interpolation function <code>f</code> that accepts one float number and returns another float number. Also we convert the given data <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> into matrix format for plotting purpose.</p>
<div class="highlight">
<pre><code class="language-ocaml">let f a =
  let v, _ = Owl_maths_interpolate.polint x y a in
  v

let xm = Mat.of_array x 1 5
let ym = Mat.of_array y 1 5</code></pre>
</div>
<p>Now we can plot the interpolation function and compare it to the Gamma function. As can be seen in <span data-cites="fig:maths:interp" class="citation">[@fig:maths:interp]</span>, both lines cross the given nodes. The interpolated line fits well with the “true interpolation”, i.e.&nbsp;the Gamma function, within a certain range. However, the extrapolation fitting where the x-value falls out of given data, is less than ideal.</p>
<div class="highlight">
<pre><code class="language-ocaml">let _ =
  let h = Plot.create "interp.png" in
  Plot.(plot_fun ~h ~spec:[ RGB (66, 133, 244); LineStyle 1; LineWidth 2.] f 2. 6.5);
  Plot.(plot_fun ~h ~spec:[ RGB (219, 68,  55); LineStyle 2; LineWidth 2.] Maths.gamma 2. 6.5);
  Plot.(scatter ~h ~spec:[ Marker "#[0x229a]"; MarkerSize 5. ] xm ym);
  Plot.(legend_on h ~position:NorthWest [|"Interpolation"; "Gamma function"; "Given values"|]);
  Plot.output h</code></pre>
</div>
<figure>
<img style="width:60.0%" id="fig:maths:interp" alt="Plot of interpolation and corresponding Gamma function." title="interp" src="images/maths/interp.png"><figcaption>Plot of interpolation and corresponding Gamma function.</figcaption>
</figure>
</section>
<section class="level2" id="integration">
<h2>Integration</h2>
<p>We have introduced some special integral functions, but we still need general integration methods that work for any input functions. Given a function <span class="math inline">\(f\)</span> that accepts a real variable and an interval <span class="math inline">\([a, b]\)</span> of the real line, the integral of this function</p>
<p><span class="math display">\[\int_a^bf(x)dx\]</span></p>
<p>can be thought of as the sum of signed area of the region in the cartesian plane that is bounded by the curve of f, the x-axis within the x-axis range <span class="math inline">\([a, b]\)</span>. The area above the x-axis adds to the sum and that below the x-axis subtracts from the area sum.</p>
<p>In the <code>Owl_maths_quandrature</code> module, Owl provides several neumerical routines to help you to do integrations. For example, we can compute <span class="math inline">\(\int_1^4x^2\)</span> with the code below:</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">Owl_maths_quadrature.trapz (fun x -&gt; x ** 2.) 1. 4.
&gt;- : float = 21.0001344681758439
</code></pre>
</div>
<p>We can verify this result using the fundamental theorem of calculus:</p>
<p><span class="math display">\[\int_1^4x^2 = (4^3 -1^3) / 3 = 21\]</span>.</p>
<p>So you might be thinking, what is this <code>trapz</code>? Why the result is not exactly <code>21</code>? Using numerical methods (or <em>quadrature</em>) to do integration dates back to the invention of calculus or even earlier. The basic idea is to use summation of small areas to approximate that of an integration. There exist a lot of algorithms to do numerical integration, and using the trapezoial rule is one of them.</p>
<p>This classical method divides <code>a</code> to <code>b</code> into <span class="math inline">\(N\)</span> equally spaced abscissas: <span class="math inline">\(x_0, x_1, \ldots, x_N\)</span>. Each area between <span class="math inline">\(x_i\)</span> and <span class="math inline">\(x_j\)</span> is seen as an “Trapezoid” and the area formula is computed as:</p>
<p><span class="math display">\[\int_{x_0}^{x_1}f(x)dx = h(\frac{f(x_0)}{2} + \frac{f(x_1)}{2}) + O(h^3f'').\]</span></p>
<p>Here the error term <span class="math inline">\(O(h^3f'')\)</span> indicated that the error of approximation is related with that of abscissas size <span class="math inline">\(h\)</span> and second order derivative of the original function. The function <code>trapz</code> implements this method. It’s interface is:</p>
<div class="highlight">
<pre><code class="language-clike">val trapz : ?n:int -&gt; ?eps:float -&gt; (float -&gt; float) -&gt; float -&gt; float -&gt; float</code></pre>
</div>
<p><code>trapz ~n ~eps f a b</code> computes the integral of <code>f</code> on the interval <code>[a,b]</code> using the trapezoidal rule. It works by iterating for several stages, each stage improving the accuracy by adding more interior points. The argument <span class="math inline">\(n\)</span> specifies the maximum step which defaults to 20, and <code>eps</code> is the desired fractional accuracy threshold, which defaults to <code>1e-6</code>.</p>
<p>The other methods are similar to <code>trapz</code> in interface, only different in implementation. For example, the <code>simpson</code> uses the Simpson formula:</p>
<p><span class="math display">\[\int_{x_0}^{x_2}f(x)dx = h(\frac{f(x_0)}{3} + \frac{4f(x_1)}{3} + \frac{f(x_2)}{3}) + O(h^5f(4)).\]</span></p>
<p>Then there is the <em>Romberg integration</em> (<code>romberg</code>) that can choose methods of different orders to give good accuracy, and the algorithms are normally much faster than the <code>trapz</code> and <code>simpson</code> methods. Moreover, if the abscissas can be varied, we have the adaptive Gaussian quadrature of fixed tolerance (<code>gaussian</code>) and Gaussian quadrature of fixed order (<code>gaussian_fixed</code>).</p>
<p>As an example, we can compute the special sine integral function <span class="math inline">\(Si(x)=\int_0^x\frac{sin(t)}{t}dt\)</span> from previous section using the numerical integration method. Let’s set <span class="math inline">\(x=4\)</span>. We can see the numerical method <code>gaussian</code> works well to approximate this special integral function.</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">let f t = Maths.(div (sin t) t)
&gt;val f : float -&gt; float = &lt;fun&gt;
Owl_maths_quadrature.gaussian f 0. 4.
&gt;- : float = 1.75820313914469306
Owl_maths.si 4.
&gt;- : float = 1.75820313894905289
</code></pre>
</div>
</section>
<section class="level2" id="utility-functions">
<h2>Utility Functions</h2>
<p>Besides what we have mentioned so far, there are also some utitlity math functions that worth mentioning.</p>
<p>We know that a prime number is a natural number greater than <code>1</code> that cannot be formed by multiplying two smaller natural numbers. It is a key idea in information technology and widely used in applications such as the public-key cryptography. The <code>is_prime</code> function checks if an integer is a prime number. This function is deterministic for all numbers representable by an int. It is implemented using the <a href="https://en.wikipedia.org/wiki/Miller%E2%80%93Rabin_primality_test">Miller-Rabin primality test</a> method.</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">Maths.is_prime 997
&gt;- : bool = true
</code></pre>
</div>
<p>Another number theory related idea is the <em>Fermat’s factorization</em>, which represents an odd integer as the difference of two squares: <span class="math inline">\(N = a^2 - b^2\)</span>, and therefore <code>N</code> can be factorised as <span class="math inline">\((a+b)(a-b)\)</span>. The function <code>fermat_fact</code> performs Fermat factorisation over odd number <code>N</code>, i.e.&nbsp;into two roughly equal factors <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> so that <span class="math inline">\(N=x\times~y\)</span>.</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">Maths.fermat_fact 6557
&gt;- : int * int = (83, 79)
83 * 79
&gt;- : int = 6557
</code></pre>
</div>
<p>Next two functions concerns the precision of float numbers in computer.</p>
<p>The <code>nextafter from to</code> returns the next representable double precision value of <code>from</code> in the direction of <code>to</code>. The other one, <code>nextafter from to</code> returns the next representable single precision value of <code>from</code> in the direction of <code>to</code>. In both cases, if <code>from</code> equals <code>to</code>, this value itself is returned. For example:</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">Maths.nextafterf 1. 2.;;
&gt;- : float = 1.00000011920928955
Maths.nextafter 1. 2.;;
&gt;- : float = 1.00000000000000022
Maths.nextafter 1. 0.;;
&gt;- : float = 0.999999999999999889
</code></pre>
</div>
</section>
<section class="level2" id="summary">
<h2>Summary</h2>
<p>We start the topic of numeric computation from the mathematics functions we are familiar with. This chapter introduces the math functions supported by Owl, including the basic and commonly used functions, some less freqently used but nontheless important special function, factorial, interpolation, extrapolation, integration, etc. Feel free to jump into any part you are interested in and use these functions to solve a mathematical problem at hand. You may find Owl as good a calculator as any other numerical library.</p>
</section>
</section>
</article></div><a href="stats.html" class="next-chapter"><div class="content"><h1><small>Next: Chapter 05</small>Statistical Functions</h1></div></a><footer><div class="content"><ul><li><a href="http://ocaml.xyz/privacy.html">Privacy Policy</a></li><li><a href="https://github.com/ryanrhymes">GitHub</a></li></ul><p>Copyright 2017-2023 Liang Wang.</p></div></footer><script src="js/jquery.min.js"></script><script src="js/min/app-min.js"></script></body></html>