<html style="" lang="en" class="js flexbox fontface"><head><meta charset="utf-8"><meta content="width=device-width, initial-scale=1.0" name="viewport"><meta content="OCaml Scientific and Engineering Computing - Tutorial Book" name="description"><meta content="OCaml, Data Science, Data Analytics, Analytics, Functional Programming, Machine Learning, Deep Neural Network, Scientific Computing, Numerical Algorithm, Tutorial, Linear Algebra, Matrix" name="keywords"><meta content="Liang Wang" name="author"><title>Visualisation - Owl Online Tutorials</title><link href="css/app.css" rel="stylesheet"><link href="css/prism.css" rel="stylesheet"><script src="js/min/modernizr-min.js"></script><script src="js/prism.js"></script><script src="https://use.typekit.net/gfj8wez.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script><script>try{Typekit.load();}catch(e){}</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1868946892712371" crossorigin="anonymous"></script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-123353217-1"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-123353217-1');</script></head><body><div class="title-bar"><div class="title"><h1>Owl Online Tutorials</h1><h5></h5><nav><a href="index.html">Home</a><a href="toc.html">Table of Contents</a><a href="https://ocaml.xyz/owl/">API Docs</a></nav></div></div><div class="wrap"><div class="left-column"><a class="to-chapter" href="toc.html"><small>Back</small><h5>Table of Contents</h5></a></div><article class="main-body"><section class="level1" id="visualisation">
<h1>Visualisation</h1>
<p>Owl is an OCaml numerical library. Besides its extensive supports to matrix operations, it also has a flexible plotting module. Owl’s <code>Plot</code> module is designed to help you in making fairly complicated plots with minimal coding efforts. It is built atop of [Plplot<a href="http://plplot.sourceforge.net/index.php"></a> but hides its complexity from users.</p>
<p>The module is cross-platform since <code>Plplot</code> calls the underlying graphics device driver to plot. However, based on our experience, the <a href="https://cran.r-project.org/web/packages/Cairo/index.html">Cairo Package</a> provides the best quality and most accurate figure so we recommend installing Cairo. In fact, the examples in this tutorial are all generated by using the <code>Cairo PNG Driver</code>, but as you will see, you can have a full control over the figures and configure them in multiple ways.</p>
<p>In the sections below, we will demonstrate, with examples, how the plotting module is used in Owl to assist you with multiple tasks in data visualisation and analysis.</p>
<section class="level2" id="create-plots">
<h2>Create Plots</h2>
<p>Let’s start with the standard way of creating a plot using <code>Plot.create</code> function. Here is its type definition in <code>Owl_plot.mli</code>:</p>
<div class="highlight">
<pre><code class="language-text">
  val create : ?m:int -&gt; ?n:int -&gt; string -&gt; handle
</code></pre>
</div>
<p>Here is an example.</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">let f x = Maths.sin x /. x in
let h = Plot.create "plot_001.png" in

Plot.set_title h "Function: f(x) = sine x / x";
Plot.set_xlabel h "x-axis";
Plot.set_ylabel h "y-axis";
Plot.set_font_size h 8.;
Plot.set_pen_size h 3.;
Plot.plot_fun ~h f 1. 15.;

Plot.output h
&gt;- : unit = ()
</code></pre>
</div>
<p>For any graph, we need to have a handle <code>h</code> by calling the <code>create</code> function. The type of images can be automatically inferred from the figure file name. In this case, we want to create a PNG image that plots the sine function. We can do that with the <code>plot_fun</code> function. Besides, we also set the x- and y-axis labels and figure title, together with the font and line size. You will find that these commands are similar to those in other plotting tools such as Matplotlib. Once you call <code>Plot.output</code>, the plot will be “sealed” and written into the final file. The generated figure is shown below.</p>
<figure>
<img style="width:70.0%" id="fig:visualisation:plot_001" alt="Basic function plot" title="plot_01" src="images/visualisation/plot_001.png"><figcaption>Basic function plot</figcaption>
</figure>
<p>If this looks too basic for you, then we have some fancy 3-D mesh graphs in the next part.</p>
</section>
<section class="level2" id="specification">
<h2>Specification</h2>
<p>For most high-level plotting functions in Owl, there is an optional parameter called <code>spec</code>. The <code>spec</code> parameter take a list of specifications to let you finer control the appearance of the plot. Every function has a set of slightly different parameters. In case you pass in some parameters that a function cannot understand, they will be simply ignored. If you pass in the same parameter for multiple times, only the last one will take effects.</p>
<p>In the following, we will provide some examples to show how to use the <code>spec</code> parameter to finer tune Owl’s plots. The first example shows how to configure the <code>mesh</code> plot using <code>ZLine</code>, <code>Contour</code>, and other <code>spec</code> parameters.</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">let x, y = Mat.meshgrid (-2.5) 2.5 (-2.5) 2.5 50 50 in
let z = Mat.(sin ((x * x) + (y * y))) in
let h = Plot.create ~m:2 ~n:3 "plot_020.png" in

Plot.subplot h 0 0;
Plot.(mesh ~h ~spec:[ ZLine XY ] x y z);

Plot.subplot h 0 1;
Plot.(mesh ~h ~spec:[ ZLine X ] x y z);

Plot.subplot h 0 2;
Plot.(mesh ~h ~spec:[ ZLine Y ] x y z);

Plot.subplot h 1 0;
Plot.(mesh ~h ~spec:[ ZLine Y; NoMagColor ] x y z);

Plot.subplot h 1 1;
Plot.(mesh ~h ~spec:[ ZLine Y; Contour ] x y z);

Plot.subplot h 1 2;
Plot.(mesh ~h ~spec:[ ZLine XY; Curtain ] x y z);

Plot.output h
&gt;- : unit = ()
</code></pre>
</div>
<figure>
<img style="width:90.0%" id="fig:visualisation:plot_020" alt="Plot specification" title="plot_20" src="images/visualisation/plot_020.png"><figcaption>Plot specification</figcaption>
</figure>
<p>The second example shows how to tune the <code>surf</code> plotting function in drawing a 3D surface.</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">let x, y = Mat.meshgrid (-1.) 1. (-1.) 1. 50 50 in
let z = Mat.(tanh ((x * x) + (y * y))) in
let h = Plot.create ~m:2 ~n:3 "plot_021.png" in

Plot.subplot h 0 0;
Plot.(surf ~h ~spec:[ ] x y z);

Plot.subplot h 0 1;
Plot.(surf ~h ~spec:[ Faceted ] x y z);

Plot.subplot h 0 2;
Plot.(surf ~h ~spec:[ NoMagColor ] x y z);

Plot.subplot h 1 0;
Plot.(surf ~h ~spec:[ Contour ] x y z);

Plot.subplot h 1 1;
Plot.(surf ~h ~spec:[ Curtain ] x y z);

Plot.subplot h 1 2;
Plot.(surf ~h ~spec:[ Altitude 10.; Azimuth 125. ] x y z);

Plot.output h
&gt;- : unit = ()
</code></pre>
</div>
<figure>
<img alt="Surf plot" title="plot_21" src="images/visualisation/plot_021.png"><figcaption>Surf plot</figcaption>
</figure>
</section>
<section class="level2" id="subplots">
<h2>Subplots</h2>
<p>You might already have spotted another feature in the previous example: subplots. Indeed, you can change the number of rows and columns of the subgraph layout by varying the number of the <code>m</code> and <code>n</code> parameters in the <code>create</code> function.</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">let f p i = match i with
  | 0 -&gt; Stats.gaussian_rvs ~mu:0. ~sigma:0.5 +. p.(1)
  | _ -&gt; Stats.gaussian_rvs ~mu:0. ~sigma:0.1 *. p.(0)
in
let y = Stats.gibbs_sampling f [|0.1;0.1|] 5_000 |&gt; Mat.of_arrays in
let h = Plot.create ~m:2 ~n:2 "plot_002.png" in
Plot.set_background_color h 255 255 255;

(* focus on the subplot at 0,0 *)
Plot.subplot h 0 0;
Plot.set_title h "Bivariate model";
Plot.scatter ~h (Mat.col y 0) (Mat.col y 1);

(* focus on the subplot at 0,1 *)
Plot.subplot h 0 1;
Plot.set_title h "Distribution of y";
Plot.set_xlabel h "y";
Plot.set_ylabel h "Frequency";
Plot.histogram ~h ~bin:50 (Mat.col y 1);

(* focus on the subplot at 1,0 *)
Plot.subplot h 1 0;
Plot.set_title h "Distribution of x";
Plot.set_ylabel h "Frequency";
Plot.histogram ~h ~bin:50 (Mat.col y 0);

(* focus on the subplot at 1,1 *)
Plot.subplot h 1 1;
Plot.set_foreground_color h 255 0 0;
Plot.set_title h "Sine function";
Plot.(plot_fun ~h ~spec:[ LineStyle 2 ] Maths.sin 0. 28.);
Plot.autocorr ~h (Mat.sequential 1 28);

(* output your final plot *)
Plot.output h
&gt;- : unit = ()
</code></pre>
</div>
<figure>
<img style="width:90.0%" id="fig:visualisation:plot_002" alt="Subplots" title="plot_002" src="images/visualisation/plot_002.png"><figcaption>Subplots</figcaption>
</figure>
</section>
<section class="level2" id="multiple-lines">
<h2>Multiple Lines</h2>
<p>You can certainly plot multiple lines (or other types of plots) on the same page. Here is one example with both sine and cosine lines in one plot.</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">let h = Plot.create "plot_024.png" in
Plot.(plot_fun ~h ~spec:[ RGB (0,0,255); Marker "#[0x2299]"; MarkerSize 8. ] Maths.sin 0. 9.);
Plot.(plot_fun ~h ~spec:[ RGB (255,0,0); Marker "#[0x0394]"; MarkerSize 8. ] Maths.cos 0. 9.);
Plot.legend_on h [|"Sine function"; "Cosine function"|];
Plot.output h
&gt;- : unit = ()
</code></pre>
</div>
<figure>
<img style="width:70.0%" id="fig:visualisation:plot_024" alt="Plot multiple lines" title="plot_24" src="images/visualisation/plot_024.png"><figcaption>Plot multiple lines</figcaption>
</figure>
<p>Here is another example which has both histogram and line plot in one figure.</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">(* generate data *)
let g x = (Stats.gaussian_pdf x ~mu:0. ~sigma:1.) *. 100. in
let y = Mat.gaussian ~mu:0. ~sigma:1. 1 1000 in

(* plot multiple data sets *)
let h = Plot.create "plot_025.png" in
Plot.set_background_color h 255 255 255;
Plot.(histogram ~h ~spec:[ RGB (255,0,50) ] ~bin:100 y);
Plot.(plot_fun ~h ~spec:[ RGB (0,0,255); LineWidth 2. ] g (-4.) 4.);
Plot.legend_on h [|"data"; "model"|];

Plot.output h
&gt;- : unit = ()
</code></pre>
</div>
<figure>
<img style="width:90.0%" id="fig:visualisation:plot_025" alt="Mix line plot and histogram" title="plot_25" src="images/visualisation/plot_025.png"><figcaption>Mix line plot and histogram</figcaption>
</figure>
<p>So as long as you “hold” the plot without calling <code>Plot.output</code>, you can plot many data sets in one figure.</p>
</section>
<section class="level2" id="legend">
<h2>Legend</h2>
<p>Legend can be turned on and off by calling <code>Plot.legend_on</code> and <code>Plot.legend_off</code> respectively. When you call <code>Plot.legend_on</code>, you also need to provide an array of legend names and the position of legend. There are eight default positions in <code>Plot</code>:</p>
<div class="highlight">
<pre><code class="language-ocaml">
  type legend_position =
    North | South | West | East | NorthWest | NorthEast | SouthWest | SouthEast
</code></pre>
</div>
<p>Despite of its messy looking, the following example shows how to use legend in Owl’s plot module.</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">(* generate data *)
let x = Mat.(uniform 1 20 *$ 10.) in
let y = Mat.(uniform 1 20) in
let z = Mat.gaussian 1 20 in

(* plot multiple data sets *)
let h = Plot.create "plot_026.png" in
Plot.(plot_fun ~h ~spec:[ RGB (0,0,255); LineStyle 1; Marker "*" ] Maths.sin 1. 8.);
Plot.(plot_fun ~h ~spec:[ RGB (0,255,0); LineStyle 2; Marker "+" ] Maths.cos 1. 8.);
Plot.scatter ~h x y;
Plot.stem ~h x z;

let u = Mat.(abs(gaussian 1 10 *$ 0.3)) in
Plot.(bar ~h ~spec:[ RGB (255,255,0); FillPattern 3 ] u);

let v = Mat.(neg u *$ 0.3) in
let u = Mat.sequential 1 10 in
Plot.(area ~h ~spec:[ RGB (0,255,0); FillPattern 4 ] u v);

(* set up legend *)
Plot.(legend_on h ~position:NorthEast [|"test 1"; "test 2"; "scatter"; "stem"; "bar"; "area"|]);
Plot.output h
&gt;- : unit = ()
</code></pre>
</div>
<figure>
<img style="width:90.0%" id="fig:visualisation:plot_026" alt="Plot with legends" title="plot_26" src="images/visualisation/plot_026.png"><figcaption>Plot with legends</figcaption>
</figure>
</section>
<section class="level2" id="drawing-patterns">
<h2>Drawing Patterns</h2>
<p>The plotting module supports multiple pattern of lines, as shown below:</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">let h = Plot.create "plot_004.png" in
Plot.set_background_color h 255 255 255;
Plot.set_pen_size h 2.;
Plot.(draw_line ~h ~spec:[ LineStyle 1 ] 1. 1. 9. 1.);
Plot.(draw_line ~h ~spec:[ LineStyle 2 ] 1. 2. 9. 2.);
Plot.(draw_line ~h ~spec:[ LineStyle 3 ] 1. 3. 9. 3.);
Plot.(draw_line ~h ~spec:[ LineStyle 4 ] 1. 4. 9. 4.);
Plot.(draw_line ~h ~spec:[ LineStyle 5 ] 1. 5. 9. 5.);
Plot.(draw_line ~h ~spec:[ LineStyle 6 ] 1. 6. 9. 6.);
Plot.(draw_line ~h ~spec:[ LineStyle 7 ] 1. 7. 9. 7.);
Plot.(draw_line ~h ~spec:[ LineStyle 8 ] 1. 8. 9. 8.);
Plot.set_xrange h 0. 10.;
Plot.set_yrange h 0. 9.;
Plot.output h
&gt;- : unit = ()
</code></pre>
</div>
<figure>
<img style="width:90.0%" id="fig:visualisation:plot_004" alt="Draw lines" title="plot_24" src="images/visualisation/plot_004.png"><figcaption>Draw lines</figcaption>
</figure>
<p>Similarly, we can also fill rectangles with different patterns, as shown in the example below.</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">let h = Plot.create "plot_005.png" in

Array.init 9 (fun i -&gt;
  let x0, y0 = 0.5, float_of_int i +. 1.0 in
  let x1, y1 = 4.5, float_of_int i +. 0.5 in
  Plot.(draw_rect ~h ~spec:[ FillPattern i ] x0 y0 x1 y1);
  Plot.(text ~h ~spec:[ RGB (0,255,0) ] 2.3 (y0-.0.2) ("pattern: " ^ (string_of_int i)))
) |&gt; ignore;

Plot.output h
&gt;- : unit = ()
</code></pre>
</div>
<figure>
<img style="width:90.0%" id="fig:visualisation:plot_005" alt="Fill patterns" title="plot_05" src="images/visualisation/plot_005.png"><figcaption>Fill patterns</figcaption>
</figure>
</section>
<section class="level2" id="line-plot">
<h2>Line Plot</h2>
<p>After getting to know these plotting elements, in the rest of chapter, we will demonstrate some different types of plots that are supported. Line plot is the most basic function. You can specify the colour, marker, and line style in the function.</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">let x = Mat.linspace 0. 2. 100 in
let y0 = Mat.sigmoid x in
let y1 = Mat.map Maths.sin x in
let h = Plot.create "plot_022.png" in
Plot.(plot ~h ~spec:[ RGB (255,0,0); LineStyle 1; Marker "#[0x2299]"; MarkerSize 8. ] x y0);
Plot.(plot ~h ~spec:[ RGB (0,255,0); LineStyle 2; Marker "#[0x0394]"; MarkerSize 8. ] x y1);
Plot.(legend_on h ~position:SouthEast [|"sigmoid"; "sine"|]);
Plot.output h
&gt;- : unit = ()
</code></pre>
</div>
<figure>
<img style="width:90.0%" id="fig:visualisation:plot_022" alt="Line plot with customised marker" title="plot_22" src="images/visualisation/plot_022.png"><figcaption>Line plot with customised marker</figcaption>
</figure>
</section>
<section class="level2" id="scatter-plot">
<h2>Scatter Plot</h2>
<p>Next is the scatter plot. Similar to line plot, you can specify the marker type and marker size. The example below actually shows the various patterns of markers. They are referenced by different ids.</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">let x = Mat.uniform 1 30 in
let y = Mat.uniform 1 30 in
let h = Plot.create ~m:3 ~n:3 "plot_006.png" in
Plot.set_background_color h 255 255 255;
Plot.subplot h 0 0;
Plot.(scatter ~h ~spec:[ Marker "#[0x2295]"; MarkerSize 5. ] x y);
Plot.subplot h 0 1;
Plot.(scatter ~h ~spec:[ Marker "#[0x229a]"; MarkerSize 5. ] x y);
Plot.subplot h 0 2;
Plot.(scatter ~h ~spec:[ Marker "#[0x2206]"; MarkerSize 5. ] x y);
Plot.subplot h 1 0;
Plot.(scatter ~h ~spec:[ Marker "#[0x229e]"; MarkerSize 5. ] x y);
Plot.subplot h 1 1;
Plot.(scatter ~h ~spec:[ Marker "#[0x2217]"; MarkerSize 5. ] x y);
Plot.subplot h 1 2;
Plot.(scatter ~h ~spec:[ Marker "#[0x2296]"; MarkerSize 5. ] x y);
Plot.subplot h 2 0;
Plot.(scatter ~h ~spec:[ Marker "#[0x2666]"; MarkerSize 5. ] x y);
Plot.subplot h 2 1;
Plot.(scatter ~h ~spec:[ Marker "#[0x22a1]"; MarkerSize 5. ] x y);
Plot.subplot h 2 2;
Plot.(scatter ~h ~spec:[ Marker "#[0x22b9]"; MarkerSize 5. ] x y);
Plot.output h
&gt;- : unit = ()
</code></pre>
</div>
<figure>
<img style="width:90.0%" id="fig:visualisation:plot_006" alt="Scatter plot" title="plot_006" src="images/visualisation/plot_006.png"><figcaption>Scatter plot</figcaption>
</figure>
</section>
<section class="level2" id="stairs-plot">
<h2>Stairs Plot</h2>
<p>The step plot is also called “stairstep plot”, since it draws the elements in a given ndarray in a stairstep-like curve.</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">let x = Mat.linspace 0. 6.5 20 in
let y = Mat.map Maths.sin x in
let h = Plot.create ~m:1 ~n:2 "plot_007.png" in
Plot.set_background_color h 255 255 255;
Plot.subplot h 0 0;
Plot.plot_fun ~h Maths.sin 0. 6.5;
Plot.(stairs ~h ~spec:[ RGB (0,128,255) ] x y);
Plot.subplot h 0 1;
Plot.(plot ~h ~spec:[ RGB (0,0,0) ] x y);
Plot.(stairs ~h ~spec:[ RGB (0,128,255) ] x y);
Plot.output h
&gt;- : unit = ()
</code></pre>
</div>
<figure>
<img style="width:90.0%" id="fig:visualisation:plot_007" alt="Stairs plot" title="plot_007" src="images/visualisation/plot_007.png"><figcaption>Stairs plot</figcaption>
</figure>
</section>
<section class="level2" id="box-plot">
<h2>Box Plot</h2>
<p>A box plot graphically shows groups of numerical data through their quartiles. It is often used in descriptive statistics.</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">let y1 = Mat.uniform 1 10 in
let y2 = Mat.uniform 10 100 in
let h = Plot.create ~m:1 ~n:2 "plot_008.png" in
Plot.subplot h 0 0;
Plot.(bar ~h ~spec:[ RGB (0,153,51); FillPattern 3 ] y1);
Plot.subplot h 0 1;
Plot.(boxplot ~h ~spec:[ RGB (0,153,51) ] y2);
Plot.output h
&gt;- : unit = ()
</code></pre>
</div>
<figure>
<img style="width:90.0%" id="fig:visualisation:plot_008" alt="Box plot" title="plot_008" src="images/visualisation/plot_008.png"><figcaption>Box plot</figcaption>
</figure>
</section>
<section class="level2" id="stem-plot">
<h2>Stem Plot</h2>
<p>Stem plot is simple, as the following code shows.</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">let x = Mat.linspace 0.5 2.5 25 in
let y = Mat.map (Stats.exponential_pdf ~lambda:0.1) x in
let h = Plot.create ~m:1 ~n:2 "plot_009.png" in
Plot.set_background_color h 255 255 255;
Plot.subplot h 0 0;
Plot.set_foreground_color h 0 0 0;
Plot.stem ~h x y;
Plot.subplot h 0 1;
Plot.(stem ~h ~spec:[ Marker "#[0x2295]"; MarkerSize 5.; LineStyle 1 ] x y);
Plot.output h
&gt;- : unit = ()
</code></pre>
</div>
<figure>
<img style="width:90.0%" id="fig:visualisation:plot_009" alt="Steam plot" title="plot_009" src="images/visualisation/plot_009.png"><figcaption>Steam plot</figcaption>
</figure>
<p>Stem plot is often used to show the autocorrelation of a variable, therefore Plot module already includes <code>autocorr</code> for your convenience.</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">let x = Mat.linspace 0. 8. 30 in
let y0 = Mat.map Maths.sin x in
let y1 = Mat.uniform 1 30 in
let h = Plot.create ~m:1 ~n:2 "plot_010.png" in
Plot.subplot h 0 0;
Plot.set_title h "Sine";
Plot.autocorr ~h y0;
Plot.subplot h 0 1;
Plot.set_title h "Gaussian";
Plot.autocorr ~h y1;
Plot.output h
&gt;- : unit = ()
</code></pre>
</div>
<figure>
<img style="width:90.0%" id="fig:visualisation:plot_010" alt="Stem plot with autocorrelation" title="plot_010" src="images/visualisation/plot_010.png"><figcaption>Stem plot with autocorrelation</figcaption>
</figure>
</section>
<section class="level2" id="area-plot">
<h2>Area Plot</h2>
<p>Area plot is similar to the line plot, but it fills the space between the line and x-axis, as shown below.</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">let x = Mat.linspace 0. 8. 100 in
let y = Mat.map Maths.atan x in
let h = Plot.create ~m:1 ~n:2 "plot_011.png" in
Plot.subplot h 0 0;
Plot.(area ~h ~spec:[ FillPattern 1 ] x y);
let x = Mat.linspace 0. (2. *. 3.1416) 100 in
let y = Mat.map Maths.sin x in
Plot.subplot h 0 1;
Plot.(area ~h ~spec:[ FillPattern 2 ] x y);
Plot.output h
&gt;- : unit = ()
</code></pre>
</div>
<figure>
<img style="width:90.0%" id="fig:visualisation:plot_011" alt="Area plot" title="plot_011" src="images/visualisation/plot_011.png"><figcaption>Area plot</figcaption>
</figure>
</section>
<section class="level2" id="histogram-cdf-plot">
<h2>Histogram &amp; CDF Plot</h2>
<p>Histogram is one of the most commonly used plot in data visualisation. Given a series of measurements, you can easily plot the histogram and empirical cumulative distribution of the data by using the <code>histogram</code> and <code>ecdf</code> plotting functions.</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">let x = Mat.gaussian 200 1 in
let h = Plot.create ~m:1 ~n:2 "plot_012.png" in
Plot.subplot h 0 0;
Plot.set_title h "histogram";
Plot.histogram ~h ~bin:25 x;
Plot.subplot h 0 1;
Plot.set_title h "empirical cdf";
Plot.ecdf ~h x;
Plot.output h
&gt;- : unit = ()
</code></pre>
</div>
<figure>
<img style="width:90.0%" id="fig:visualisation:plot_012" alt="Histogram plot and CDF" title="plot_012" src="images/visualisation/plot_012.png"><figcaption>Histogram plot and CDF</figcaption>
</figure>
</section>
<section class="level2" id="log-plot">
<h2>Log Plot</h2>
<p>In the Owl plots, you can choose to use the log-scale on either or both x and y axis.</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">let x = Mat.logspace (-1.5) 2. 50 in
let y = Mat.map Maths.exp x in
let h = Plot.create ~m:2 ~n:2 "plot_013.png" in

Plot.subplot h 0 0;
Plot.set_xlabel h "Input Data X";
Plot.set_ylabel h "Input Data Y";
Plot.(loglog ~h ~spec:[ RGB (0,255,0); LineStyle 2; Marker "+" ] ~x:x y);

Plot.subplot h 0 1;
Plot.set_xlabel h "Index of Input Data Y";
Plot.set_ylabel h "Input Data Y";
Plot.(loglog ~h ~spec:[ RGB (0,0,255); LineStyle 1; Marker "*" ] y);

Plot.subplot h 1 0;
Plot.set_xlabel h "Input Data X";
Plot.set_ylabel h "Input Data Y";
Plot.semilogx ~h ~x:x y;

Plot.subplot h 1 1;
Plot.set_xlabel h "Index of Input Data Y";
Plot.set_ylabel h "Input Data Y";
Plot.semilogy ~h y;

Plot.output h
&gt;- : unit = ()
</code></pre>
</div>
<figure>
<img style="width:90.0%" id="fig:visualisation:plot_013" alt="Change plot scale on x- and y-axis to log" title="plot_013" src="images/visualisation/plot_013.png"><figcaption>Change plot scale on x- and y-axis to log</figcaption>
</figure>
</section>
<section class="level2" id="d-plot">
<h2>3D Plot</h2>
<p>We have seen examples of 3D plots above. There are four functions in <code>Plot</code> module related to 3D plot. They are <code>surf</code>, <code>mesh</code>, <code>heatmap</code>, and <code>contour</code> functions. First, let’s look at <code>mesh</code> and <code>surf</code> functions.</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">let x, y = Mat.meshgrid (-2.5) 2.5 (-2.5) 2.5 100 100 in
let z0 = Mat.(sin ((x **$ 2.) + (y **$ 2.))) in
let z1 = Mat.(cos ((x **$ 2.) + (y **$ 2.))) in
let h = Plot.create ~m:2 ~n:2 "plot_014.png" in
Plot.subplot h 0 0;
Plot.surf ~h x y z0;
Plot.subplot h 0 1;
Plot.mesh ~h x y z0;
Plot.subplot h 1 0;
Plot.surf ~h x y z1;
Plot.subplot h 1 1;
Plot.mesh ~h x y z1;
Plot.output h
&gt;- : unit = ()
</code></pre>
</div>
<figure>
<img style="width:90.0%" id="fig:visualisation:plot_014" alt="3D plot" title="plot_014" src="images/visualisation/plot_014.png"><figcaption>3D plot</figcaption>
</figure>
<p>It is easy to control the viewpoint with <code>altitude</code> and <code>azimuth</code> parameters. Here is an example.</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">let x, y = Mat.meshgrid (-2.5) 2.5 (-2.5) 2.5 100 100 in
let z = Mat.(sin ((x * x) + (y * y))) in
let h = Plot.create ~m:1 ~n:3 "plot_015.png" in
Plot.subplot h 0 0;
Plot.(mesh ~h ~spec:[ Altitude 50.; Azimuth 120. ] x y z);
Plot.subplot h 0 1;
Plot.(mesh ~h ~spec:[ Altitude 65.; Azimuth 120. ] x y z);
Plot.subplot h 0 2;
Plot.(mesh ~h ~spec:[ Altitude 80.; Azimuth 120. ] x y z);
Plot.output h
&gt;- : unit = ()
</code></pre>
</div>
<p>The generated figure is shown as below.</p>
<figure>
<img style="width:90.0%" id="fig:visualisation:plot_015" alt="Customised 3D Plot, example 1" title="plot_015" src="images/visualisation/plot_015.png"><figcaption>Customised 3D Plot, example 1</figcaption>
</figure>
<p>Here is another similar example with different functions.</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">let x, y = Mat.meshgrid (-3.) 3. (-3.) 3. 50 50 in
let z = Mat.(
  3. $* ((1. $- x) **$ 2.) * exp (neg (x **$ 2.) - ((y +$ 1.) **$ 2.)) -
  (10. $* (x /$ 5. - (x **$ 3.) - (y **$ 5.)) * (exp (neg (x **$ 2.) - (y **$ 2.)))) -
  ((1./.3.) $* exp (neg ((x +$ 1.) **$ 2.) - (y **$ 2.)))
  )
in

let h = Plot.create ~m:2 ~n:3 "plot_016.png" in
Plot.subplot h 0 0;
Plot.surf ~h x y z;
Plot.subplot h 0 1;
Plot.mesh ~h x y z;
Plot.subplot h 0 2;
Plot.(surf ~h ~spec:[ Contour ] x y z);
Plot.subplot h 1 0;
Plot.(mesh ~h ~spec:[ Contour; Azimuth 115.; NoMagColor ] x y z);
Plot.subplot h 1 1;
Plot.(mesh ~h ~spec:[ Azimuth 115.; ZLine X; NoMagColor; RGB (61,129,255) ] x y z);
Plot.subplot h 1 2;
Plot.(mesh ~h ~spec:[ Azimuth 115.; ZLine Y; NoMagColor; RGB (130,255,40) ] x y z);
Plot.output h
&gt;- : unit = ()
</code></pre>
</div>
<figure>
<img style="width:90.0%" id="fig:visualisation:plot_016" alt="Customised 3D Plot, example 2" title="plot_016" src="images/visualisation/plot_016.png"><figcaption>Customised 3D Plot, example 2</figcaption>
</figure>
<p>Finally, let’s look at how heatmap and contour plot look like, using the same function as before.</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">let x, y = Mat.meshgrid (-3.) 3. (-3.) 3. 100 100 in
let z = Mat.(
  3. $* ((1. $- x) **$ 2.) * exp (neg (x **$ 2.) - ((y +$ 1.) **$ 2.)) -
  (10. $* (x /$ 5. - (x **$ 3.) - (y **$ 5.)) * (exp (neg (x **$ 2.) - (y **$ 2.)))) -
  ((1./.3.) $* exp (neg ((x +$ 1.) **$ 2.) - (y **$ 2.)))
  )
in

let h = Plot.create ~m:2 ~n:2 "plot_017.png" in
Plot.subplot h 0 0;
Plot.(mesh ~h ~spec:[ Contour ] x y z);
Plot.subplot h 0 1;
Plot.heatmap ~h x y z;
Plot.subplot h 1 0;
Plot.mesh ~h x y z;
Plot.subplot h 1 1;
Plot.contour ~h x y z;
Plot.output h
&gt;- : unit = ()
</code></pre>
</div>
<figure>
<img style="width:90.0%" id="fig:visualisation:plot_017" alt="Headmap and contour plot" title="plot_017" src="images/visualisation/plot_017.png"><figcaption>Headmap and contour plot</figcaption>
</figure>
</section>
<section class="level2" id="advanced-statistical-plot">
<h2>Advanced Statistical Plot</h2>
<p>Besides these commonly used basic plot types, we also support several advanced statistical plots. For example, both the <code>qqplot</code> and <code>probplot</code> are simple graphical tests for determining if a data set comes from a certain distribution.</p>
<p>A <code>qqplot</code> displays a quantile-quantile plot of the quantiles of the sample data y versus the theoretical quantiles values from a given distribution, or the quantiles of the sample data x. Here is an example.</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">let y = Mat.(gaussian 100 1 *$ 10.) in
let x = Mat.gaussian 200 1 in
let h = Plot.create ~m:2 ~n:2 "plot_018.png" in

Plot.subplot h 0 0;
Plot.set_title h "Gaussian vs. Gaussian Sample";
Plot.set_ylabel h "Quantiles of Input Sample";
Plot.set_xlabel h "Normal Distribution Quantiles";
Plot.qqplot ~h y ~x:x;

Plot.subplot h 0 1;
Plot.set_title h "Gaussian vs. Default Dist";
Plot.set_ylabel h "Quantiles of Input Sample";
Plot.set_xlabel h "Normal Distribution Quantiles";
Plot.(qqplot ~h y ~spec:[RGB (0,128,255)]);

Plot.subplot h 1 0;
Plot.set_title h "Gaussian vs. Rayleigh Dist";
Plot.set_ylabel h "Quantiles of Input Sample";
Plot.set_xlabel h "Rayleigh Distribution (sigma=0.5) Quantiles";
Plot.qqplot ~h y ~pd:(fun p -&gt; Stats.rayleigh_ppf p 0.5);

Plot.subplot h 1 1;
Plot.set_title h "Gaussian vs. Chi-Square Dist";
Plot.set_ylabel h "Quantiles of Input Sample";
Plot.set_xlabel h "Chi-Square Distribution (k=10) Quantiles";
Plot.qqplot ~h y ~pd:(fun p -&gt; Stats.chi2_ppf p 10.);

Plot.output h
&gt;- : unit = ()
</code></pre>
</div>
<figure>
<img style="width:90.0%" id="fig:visualisation:plot_018" alt="Advanced statistical plots with qqplot" title="plot_018" src="images/visualisation/plot_018.png"><figcaption>Advanced statistical plots with qqplot</figcaption>
</figure>
<p>The <code>probplot</code> is similar to <code>qqplot</code>. It contains two special cases: <code>normplot</code> for when the given theoretical distribution is Normal distribution, and <code>wblplot</code> for Weibull Distribution. Here is an example of them.</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">let x = Mat.empty 200 1 |&gt; Mat.map (fun _ -&gt; Stats.weibull_rvs 1.2 1.5) in
let h = Plot.create ~m:1 ~n:2 "plot_019.png" in

Plot.subplot h 0 0;
Plot.set_title h "Random Weibull Sample vs. Std Normal Dist";
Plot.set_xlabel h "Sample Data";
Plot.set_ylabel h "Theoretical Normal Dist";
Plot.normplot ~h x;

Plot.subplot h 0 1;
Plot.set_title h "Random Weibull Sample vs. Weibull Dist";
Plot.set_xlabel h "Sample Data";
Plot.set_ylabel h "Theoretical Weibull Dist";
Plot.wblplot ~h ~lambda:1.2 ~k:1.5 x;
Plot.output h
&gt;- : unit = ()
</code></pre>
</div>
<figure>
<img style="width:90.0%" id="fig:visualisation:plot_019" alt="Advanced statistical plots with probplot" title="plot_019" src="images/visualisation/plot_019.png"><figcaption>Advanced statistical plots with probplot</figcaption>
</figure>
</section>
<section class="level2" id="summary">
<h2>Summary</h2>
<p>This chapter demonstrate the plotting module in Owl, including how to create, manipulate plots, to the different types of plots that are supported. This chapter provides a lot of examples. It aims to be a manual that you can keep going back to check when you need visualisation in your task. In fact, most of the plots in this book are based on this module.</p>
<p>One pitfall in this chapter is that, we may not have given too much consideration about the “color harmony”. The default choice of colour may not always be pleasing to your eyes. The good news is that, you can easily change the colors in the plot. Try google “colour theory” and you can find a lot of guidelines. For example, the analogous colours can be a good choice in your line plots. These colours are any sequential three colors on a 12-part color wheel, such as yellow-green, yellow, and yellow-orange. We find this artistic aspect of visualisation is often enjoyable.</p>
</section>
<section class="level2" id="references">
<h2>References</h2>
</section>
</section>
</article></div><a href="maths.html" class="next-chapter"><div class="content"><h1><small>Next: Chapter 04</small>Mathematical Functions</h1></div></a><footer><div class="content"><ul><li><a href="http://ocaml.xyz">ocaml.xyz</a></li><li><a href="https://github.com/ryanrhymes">GitHub</a></li></ul><p>Copyright 2017-2020 Liang Wang.</p></div></footer><script src="js/jquery.min.js"></script><script src="js/min/app-min.js"></script></body></html>